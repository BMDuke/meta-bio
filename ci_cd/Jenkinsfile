node {

    checkout scm

    stage 'Build'
    def metadata_api_image = docker.build("metadata_api", "./api")


    stage 'Test'
    
    
//     sh 'mkdir results'
    metadata_api_image.run('-v ${JENKINS_HOME}/results:api/results', 'shell pytest -v --junitxml=results/results.xml')

    // metadata_api_image.inside {

    //     shell 'mkdir junit'
    //     shell 'pytest'

    // }


    stage 'Deploy'

    

}
